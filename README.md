# README.md к проекту "MyParser" (Fullstack)

---

## Обзор

"MyParser" - веб-приложение, которое позволяет делать парсинг HH.ru, сохранять найденные вакансии в БД. 

Платформа парсинга данных с HeadHunter.ru, написанная на языке python с использованием библиотеки requests, взаимодействует с API HH.RU (https://api.hh.ru/) с помощью токена и собирает информацию о вакансиях. Все полученные данные хранятся в базе данных PostgreSQL. Для удобства пользования реализован веб-интерфейс с помощью фреймворка Flask. Вся система упакована в Docker-контейнеры и поднимается посредством Docker Compose.

Над проектом работала студентка группы БВТ2303 Васюкова Наталья.

---

## План
Начало работы: 24/06/2024
Дата зачёта/сдачи: 06/07/2024

Цель: реализовать парсер, спроектировать БД, упаковать в Docker, создать гит-репозиторий, провести тесты, написать ReadME-файл и инструкцию пользователя, заполнить дневник и отчёт.

---

## Технологический стек

- Python: Высокоуровневый язык программирования.
- API HH.ru: предоставляет доступ к API портала HeadHunter.ru для получения информации о вакансиях
- Библиотека requests: Позволяет отправлять HTTP-запросы на сервер и обрабатывать полученные ответы. Широко используется для работы с API.
- Библиотека time: Предоставляет функционал для работы со временем и датами в Python. Позволяет измерять прошедшее время, управлять задержками и таймаутами.
- PostgreSQL: Реляционная база данных. Обладает высокой производительностью.
- Библотека psycopg2: используется для работы с базами данных PostgreSQL на языке Python. Позволяет реализовать подключение к БД и выполнение SQL-запросов.
- Flask: Микрофреймворк для создания веб-приложений на языке Python. Обладает минималистичной структурой, но при этом предоставляет возможности для разработки расширенных веб-приложений.
- CSS: Каскадные таблицы стилей, используемые для оформления и стилизации веб-страниц. Позволяют задавать внешний вид элементов, расположение блоков, цвета и шрифты.
- Bootstrap: Фреймворк для создания адаптивных и красивых веб-интерфейсов. Предоставляет готовые компоненты, сетки и стили.
- Docker: Платформа для разработки, доставки и запуска приложений в контейнерах. Облегчает процесс управления зависимостями, развертывания приложений и обеспечивает изоляцию приложений в среде исполнения.
- Git: система контроля версий, используется для управления кодом проекта.
- GitHub: платформа для хранения кода проекта.
- VS Code: редактор кода.
- Bearded Theme: расширение для изменения темы VS Code

---

## Структура файлов

<pre>
MyParser5_DOCKER/    
│    
├── _pycache_/                #  Кеширование скомпилированных файлов .py в байт-коде для возможного повторного использования   
│    
├── static/                   # Статические файлы (изображения)  
│   └── css/                  # Файлы CSS  
│       ├── main.css          # Стили первой страницы   
│       └── results.css       # Стили второй страницы  
│    
├── templates/                # Шаблоны (макеты) - могут быть использованы для создания веб-страниц  
│   ├── contacts.html         # Страница контактов  
│   ├── index.html            # Первая страница   
│   └── results.html          # Вторая страницы  
│    
├── venv                      # Виртуальная среда Python.  
├── app.py                    # Главный файл приложения  
├── docker-compose.yml        # Файл конфигурации Docker Compose  
├── Dockerfile                # Файл для создания образа Docker  
├── functions.py              # Backend  
└── requirements.txt          # Зависимости Python  
</pre>

---

## Модули

- app.py: создание и настройка приложения Flask, маршрутизация.
- parser.py: модуль, отвечающий за парсинг данных и подключение к БД PostgreSQL. Содержит функции для извлечения информации и обработки данных парсинга.
- templates/index.html: HTML шаблон для отображения результатов парсинга на веб-странице.
- static/style.css - стили CSS для всего приложения.

---

## Взаимодействие с backend

Взаимодействие с backend осуществляется через HTTP запросы к Flask приложению.

Для взаимодействия с backend используется библиотека Flask для обработки HTTP запросов и создания RESTful API. Для работы с базой данных PostgreSQL используется библиотека SQLAlchemy.

Основные маршруты и их функциональность для взаимодействия с backend.

1. **GET /**
   - Описание: функция getPage отправляет GET запрос на указанный URL и возвращает данные в формате JSON. Используется для получения данных о вакансиях с сайта hh.ru.
   - Вход: Параметры page (номер страницы) и keyword (ключевое слово для поиска).
     Пример запроса: `http://localhost:5000/?keyword=Python&key_pages_number=2`
   - Действие: Функция отправляет GET запрос на https://api.hh.ru/vacancies с указанными параметрами.
   - Выход: Возвращает данные о вакансиях в формате JSON.

2. **GET /results**
   - Описание: Маршрут для проведения аналитики на сервере (БД).
   - Вход: Переменные, собранные с HTML страницы с помощью request.args.get.
     Пример запроса: `http://localhost:5000/results?key_area_db=Москва`
   - Действие: Выполняет вычисления, используя функции из файла functions.py, включая взаимодействие с базой данных PostgreSQL.
   - Выход: Возвращает результат вычислений на страницу через render_template().
   - Примечание: подробнее в маршруте 4.
    
3. **POST (insert_Data)**
   - Описание: функция insert_data осуществляет добавление данных о вакансии в таблицу vacancies.
   - Вход: JSON объект с данными о вакансии.
     Пример данных:
     `{  
         "vacancy_id": 123,  
         "vacancy_title": "Название вакансии",  
         "company_name": "Название компании",  
         "vacancy_url": "Ссылка на вакансию",  
         "salary_range": "Диапазон зарплат",  
         "vacancy_area": "Регион вакансии",  
         "experience": "Требуемый опыт работы",  
         "employment": "Тип занятости"  
     }`  
   - Выход: Добавляет данные о вакансии в таблицу vacancies в базе данных. После успешного выполнения запроса возвращается статус 200.
   - Пример использования функции insert_data:
     `insert_data(conn, vacancy_id, vacancy_title, company_name, vacancy_url, salary_range, vacancy_area, experience, employment)`
   - Примечание: Пожалуйста, убедитесь, что перед вызовом функции insert_data установлено соединение с базой данных (conn).
     
4. **GET к (get_vacancies_exp)**
   - Описание: функция get_vacancies_exp(key_area_db, key_experience_db, key_employment_db) используется для выполнения запросов к базе данных PostgreSQL. Позволяет получить список вакансий из БД с учетом фильтров.
   - Вход: параметры key_area_db (опциональный), key_experience_db (опциональный), key_employment_db (опциональный).
   - Выход: JSON объект с данными о вакансиях.
   - Примечание: при отсутствии всех трёх параметров, будут возвращены все вакансии БД.

---

## Контакты

[Группа вк](https://vk.com/club226042324)

Телеграмм Fullstack-разработчика:
`Васюкова Наталья Павловна - @nata_lotal`

---

## Установка и запуск

1. В начале необходимо скачать данный репозиторий с гитхаба либо сделать git clone, для этого нужно воспользоваться терминалом PowerShell:
    cd "C:\папка"
    git clone https://github.com/Vasyukova-Nat/MyParser.git -b master
2. С гитхаба все файлы реакт-приложения копируются вместе с папкой MyParser - это лишний уровень. На этом этапе нужно перейти в неё командой cd, либо переместить всё её содержимое на один уровень выше, удалив после этого пустую лишнюю папку MyParser.
3. Приложение запускается через Docker. Установка зависимостей и библиотек не требуется.
    docker-compose up --build
4. В консоль PowerShell выведется информация о том, что веб-приложение запущено:
`Running on http://127.0.0.1:5000`
После перехода по данной ссылке перед Вами откроется сайт MyParser.

---

## Инструкция пользователя

Сайт состоит из трёх страниц: парсинга (первая), вывода содержимого базы данных (вторая) и контактов.

На каждой из трёх страниц есть хэдер для удобного переключения между тремя страницами, а также футер с краткой информацией о разработчике.

На первой странице находятся 2 поля для взаимодействия: 
- В первое вводится ключевое слово, по которому нужно искать вакансии. Допустим ввод на английском и русском языках.
- Во второе поле вводится количество страниц, которое пользователь хотел бы собрать (на одной странице 10 вакансий). Для получения корректных результатов рекомендуется ввод чисел от 1 до 200 (т.к. максимальное ограничение бесплатного использования API HH.ru - 2000 вакансий). В случае, если количество активных вакансий на сайте HH.ru меньше запрошенного пользователем значения, может появиться ошибка.

Оба поля обязательно должны быть заполнены.  
Справа от полей находится кнопка, по нажатию которой начинается сбор вакансий.

На второй странице пользователь может заполнить фильтры:
- Город - можно ввести любое текстовое значение, но важно помнить, что на HH.ru указываются только города на русском языке
- Опыт работы - выбрать из перечисленных вариантов
- Занятость - выбрать из перечисленных вариантов

Кнопка справа от фильтров выводит из базы данных найденные по введённым фильтрам вакансии, если хотя бы один фильтр был заполнен, или всё содержимое БД, если пользователь оставил пустыми все 3 фильтра.

На странице "Контакты" указана подробная информация о разработчике.

---

## Тестирование 

- Тестирование: проводились ручные тесты.

Нагрузочный тест: проверка работоспособности сайта при парсинге большого числа вакансий (2000).

---

## Артефакты проекта

Данная документация, а также файлы, прикрепленные в личном кабинете.

